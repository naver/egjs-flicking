/*
Copyright (c) 2017 NAVER Corp.
@egjs/flicking JavaScript library
@egjs/flicking project is licensed under the MIT license

https://github.com/naver/egjs-flicking
@version 3.0.0-beta4
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@egjs/component"),require("@egjs/axes")):"function"==typeof define&&define.amd?define(["@egjs/component","@egjs/axes"],e):((t=t||self).eg=t.eg||{},t.eg.Flicking=e(t.eg.Component,t.eg.Axes))}(this,function(t,o){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function p(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return t.forEach(function(n){Object.keys(n).forEach(function(t){var e=n[t];i[t]=e})}),i}var s=function(){var t={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",OTransform:"-o-transform",transform:"transform"},e=document.documentElement.style,n="";for(var i in t)i in e&&(n=i);if(!n)throw new Error("Browser doesn't support CSS3 2D Transforms.");var o=document.createElement("div");document.documentElement.insertBefore(o,null),o.style[n]="translate3d(1px, 1px, 1px)";var r=window.getComputedStyle(o).getPropertyValue(t[n]);o.parentElement.removeChild(o);var a={name:n,has3d:0<r.length&&"none"!==r};return s=function(){return a},a};function a(e,n){Object.keys(n).forEach(function(t){e.style[t]=n[t]})}function f(t,e,n){return Math.max(Math.min(t,n),e)}function d(t,e,n){return e<=t&&t<=n}function g(t,e,n){var i=null!=n?n:e/2,o=/(?:(\+|\-)\s*)?(\d+(?:\.\d+)?(%|px)?)/g;if("number"==typeof t)return f(t,0,e);for(var r=0,a=0,s=o.exec(t);null!=s;){var l=s[1],c=s[2],h=s[3],u=parseFloat(c);if(r<=0&&(l=l||"+"),!l)return i;"%"===h&&(u=u/100*e),a+="+"===l?u:-u,++r,s=o.exec(t)}return 0===r?i:f(a,0,e)}function b(t,e){var n=e[0],i=e[1],o=e[2];return i<t&&o-i?(t-i)/(o-i):t<i&&i-n?(t-i)/(i-n):t!==i&&o-n?(t-n)/(o-n):0}var v={classPrefix:"eg-flick",deceleration:.0075,horizontal:!0,circular:!1,threshold:40,duration:100,panelEffect:function(t){return 1-Math.pow(1-t,3)},defaultIndex:0,inputType:["touch","mouse"],thresholdAngle:45,bounce:10,autoResize:!1,adaptive:!1,zIndex:2e3,bound:!1,overflow:!1,hanger:"50%",anchor:"50%",gap:0,snap:1,freeScroll:!1},l={position:"relative",zIndex:v.zIndex,width:"100%",height:"100%",willChange:"transform",overflow:"hidden"},c={width:"100%",height:"100%"},h={position:"absolute"},M={HOLD_START:"holdStart",HOLD_END:"holdEnd",MOVE_START:"moveStart",MOVE:"move",MOVE_END:"moveEnd",CHANGE:"change",RESTORE:"restore",SELECT:"select",NONE:""},P={HOLD:"hold",CHANGE:"change",RELEASE:"release",ANIMATION_END:"animationEnd",FINISH:"finish"},u=0,m=1,x=2,R=3,O=4,E={PREV:"PREV",NEXT:"NEXT"},A=s(),S=function(){function i(t,e,n){var i,o;this.element=t,this.state={index:e,horizontal:n.horizontal,position:0,anchorExpression:n.anchorExpression,relativeAnchorPosition:0,size:0,clonedPanels:[],isClone:!1,cloneIndex:-1,originalStyle:{className:t.getAttribute("class")||null,style:t.getAttribute("style")||null},cachedBbox:null},n.classPrefix&&(i=t,o=n.classPrefix+"-panel",i.classList?i.classList.add(o):i.className.indexOf(o)<0&&(i.className=(i.className+" "+o).replace(/\s{2,}/g," "))),a(this.element,h),this.resize()}var t=i.prototype;return t.resize=function(){var t=this.state;t.cachedBbox=null;var e=this.getBbox();t.size=t.horizontal?e.width:e.height,t.isClone||t.clonedPanels.forEach(function(t){return t.resize()})},t.destroy=function(){var t=this.element,e=this.state.originalStyle;for(var n in e.className?t.setAttribute("class",e.className):t.removeAttribute("class"),e.style?t.setAttribute("style",e.style):t.removeAttribute("style"),this)this[n]=null},t.getElement=function(){return this.element},t.getAnchorPosition=function(){return this.state.position+this.state.relativeAnchorPosition},t.getRelativeAnchorPosition=function(){return this.state.relativeAnchorPosition},t.getIndex=function(){return this.state.index},t.getPosition=function(){return this.state.position},t.getSize=function(){return this.state.size},t.getPrevPanel=function(){return this.prevPanel},t.getNextPanel=function(){return this.nextPanel},t.getBbox=function(){var t=this.state;return t.cachedBbox||(t.cachedBbox=this.element.getBoundingClientRect()),t.cachedBbox},t.isClone=function(){return this.state.isClone},t.getCloneIndex=function(){return this.state.cloneIndex},t.getClonedPanels=function(){return this.state.clonedPanels},t.getIdenticalPanels=function(){var t=this.state;return t.isClone?this.original.getIdenticalPanels():[this].concat(t.clonedPanels)},t.setPosition=function(t){var e=this.state,n=this.element.style;e.position=t,e.horizontal?n.left=t+"px":n.top=t+"px",e.relativeAnchorPosition=g(e.anchorExpression,e.size)},t.setPrevPanel=function(t){this.prevPanel=t},t.setNextPanel=function(t){this.nextPanel=t},t.clone=function(t){var e=this.state,n=new i(this.element.cloneNode(!0),e.index,{anchorExpression:e.anchorExpression,horizontal:e.horizontal});return n.original=this,n.state.isClone=!0,n.state.cloneIndex=t,n.state.size=e.size,e.clonedPanels.push(n),n},t.removeClonedPanelsAfter=function(t){for(var e=0,n=this.state.clonedPanels.splice(t);e<n.length;e++){var i=n[e].getElement();i.parentNode.removeChild(i)}},i}(),T=function(){function t(t,e,n){this.clonedPanels=[],this.viewportElement=t,this.cameraElement=e,this.state={index:n.defaultIndex,size:0,position:0,hangerPosition:0,scrollArea:{prev:0,next:0},translate:A},this.options=n,this.build()}var e=t.prototype;return e.moveTo=function(t,e,n){void 0===n&&(n=this.options.duration);var i=this.state,o=this.options.freeScroll,r=t.anchorPosition-i.hangerPosition;r=this.canSetBoundMode()?f(r,i.scrollArea.prev,i.scrollArea.next):r,i.index=t.index,e&&e.setTo?e.setTo({flick:o?e.destPos.flick:r},n):this.axes.setTo({flick:r},n)},e.moveCamera=function(t){var e=this.state,n=e.translate.name,i=(this.options.horizontal?[-t,0]:[0,-t]).map(function(t){return Math.round(t)+"px"}).join(", ");this.cameraElement.style[n]=e.translate.has3d?"translate3d("+i+", 0px)":"translate("+i+")",e.position=t},e.resize=function(){this.updateSize(),this.updateOriginalPanelPositions(),this.updateAdaptiveSize(),this.updateScrollArea(),this.options.circular&&(this.clonePanels(),this.relocatePanels()),this.chainPanels(),this.updateCameraPosition()},e.findNearestPanel=function(){var t=this.state,e=this.panels,n=this.clonedPanels,i=t.scrollArea,o=t.position+t.hangerPosition;if(this.isOutOfBound())return t.position<i.prev?e[0]:e[e.length-1];for(var r,a=1/0,s=0,l=e.concat(n);s<l.length;s++){var c=l[s],h=c.getPosition(),u=h+c.getSize(),f=d(o,h,u)?0:Math.min(Math.abs(h-o),Math.abs(u-o));if(a<f)break;a=f,r=c}return r},e.findPanelOf=function(t){for(var e=0,n=this.panels.concat(this.clonedPanels);e<n.length;e++){var i=n[e];if(i.getElement().contains(t))return i}},e.findNearestIdenticalPanel=function(t){var e=this.state,i=t,o=1/0,r=e.position+e.hangerPosition;return t.getIdenticalPanels().forEach(function(t){var e=t.getAnchorPosition(),n=Math.abs(e-r);n<o&&(i=t,o=n)}),i},e.findShortestPositionToPanel=function(t){var e=this.state,n=this.options,i=t.getAnchorPosition(),o=Math.abs(e.position+e.hangerPosition-i),r=e.scrollArea.next-e.scrollArea.prev;if(n.circular)return o<=r-o?i-e.hangerPosition:i>e.position+e.hangerPosition?i-e.hangerPosition-r:i-e.hangerPosition+r;var a=i-e.hangerPosition;return this.canSetBoundMode()?f(a,e.scrollArea.prev,e.scrollArea.next):a},e.enable=function(){this.panInput.enable()},e.disable=function(){this.panInput.disable()},e.updateAdaptiveSize=function(){var t,e=this.options,i=e.horizontal;if(e.adaptive){var n=this.getCurrentPanel().getBbox();t=i?n.height:n.width}else{t=this.panels.reduce(function(t,e){var n=e.getBbox();return Math.max(t,i?n.height:n.width)},0)}var o=this.viewportElement.style;i?(o.height=t+"px",o.minHeight="100%",o.width="100%"):(o.width=t+"px",o.minWidth="100%",o.height="100%")},e.destroy=function(){var t=this.viewportElement,e=t.parentElement;for(var n in e.removeChild(t),this.axes.destroy(),this.panInput.destroy(),this.panels.forEach(function(t){e.appendChild(t.getElement()),t.destroy()}),this)this[n]=null},e.restore=function(t){var e=t.panels,n=this.cameraElement;n.innerHTML=e.map(function(t){return t.html}).join(""),this.viewportElement.appendChild(n),this.state.index=t.index,this.moveCamera(t.position),this.panels=[],this.clonedPanels=[],this.createPanels(),this.resize()},e.getPanelCount=function(){return this.panels.length},e.getPanel=function(t){return d(t,0,this.panels.length-1)?this.panels[t]:null},e.getCurrentPanel=function(){return this.panels[this.state.index]},e.getIndex=function(){return this.state.index},e.getPrevIndex=function(){var t=this.state.index-1;return t<0&&(t=this.options.circular?this.panels.length-1:-1),t},e.getNextIndex=function(){var t=this.state.index+1;return t>=this.panels.length&&(t=this.options.circular?0:-1),t},e.getSize=function(){return this.state.size},e.getScrollArea=function(){return this.state.scrollArea},e.getScrollAreaSize=function(){var t=this.state.scrollArea;return t.next-t.prev},e.getHangerPosition=function(){return this.state.hangerPosition},e.getCameraPosition=function(){return this.state.position},e.getAllPanels=function(t){var e=this.panels;return t?e.concat(this.clonedPanels):e},e.connectAxesHandler=function(t){var e=this.axes;this.axesHandlers=t,e.on(t),this.resume()},e.pause=function(){this.axes.off()},e.resume=function(){this.axes.on(this.axesHandlers)},e.build=function(){this.applyCSSValue(),this.setAxesInstance(),this.createPanels(),this.resize(),this.moveToDefaultPanel()},e.applyCSSValue=function(){var t=this.options,e=this.viewportElement,n=this.cameraElement,i=t.classPrefix;e.className=i+"-viewport",n.className=i+"-camera",a(e,l),a(n,c),t.zIndex&&(e.style.zIndex=""+t.zIndex),t.overflow&&(e.style.overflow="visible")},e.setAxesInstance=function(){var t=this.state,e=this.options,n=t.scrollArea,i=e.horizontal;this.axes=new o({flick:{range:[n.prev,n.next],circular:e.circular,bounce:[0,0]}},{easing:e.panelEffect,deceleration:e.deceleration,interruptable:!0}),this.panInput=this.makeNewPanInput(),this.axes.connect(i?["flick",""]:["","flick"],this.panInput)},e.createPanels=function(){var t,e=this.state,n=this.options,i=this.cameraElement.children;if(!i||!i.length)throw new Error("There're no panel elements.");this.panels=(t=i,[].slice.call(t)).map(function(t,e){return new S(t,e,{horizontal:n.horizontal,classPrefix:n.classPrefix,anchorExpression:n.anchor})}),e.index=f(e.index,0,this.panels.length-1)},e.clonePanels=function(){var i=this,t=this.state,e=this.panels,o=this.clonedPanels,n=t.size,r=e[e.length-1],a=r.getPosition()+r.getSize()+this.options.gap,s=n+e[0].getRelativeAnchorPosition(),l=o[o.length-1],c=Math.ceil(s/a),h=l?l.getCloneIndex()+1:0;if(h<c)for(var u=function(n){e.forEach(function(t){var e=t.clone(n);i.appendPanelElement(e.getElement()),o.push(e)})},f=h;f<c;f++)u(f);else c<h&&(e.forEach(function(t){t.removeClonedPanelsAfter(c)}),this.clonedPanels.splice(c*e.length))},e.relocatePanels=function(){var t=this.state,e=this.options,n=this.panels,i=this.clonedPanels,o=t.scrollArea,r=o.next+t.size,a=(o.prev,n[0]),s=n[n.length-1];if(a){for(var l=s.getPosition()+s.getSize()+e.gap,c=0,h=i;c<h.length;c++){var u=(v=h[c]).getIdenticalPanels()[0],f=l*(v.getCloneIndex()+1)+u.getPosition();v.setPosition(f)}for(var p=a.getPosition(),d=0,g=i.concat().reverse();d<g.length;d++){var v,P=(v=g[d]).getPosition(),m=p-v.getSize()-e.gap;if(P<=r)break;v.setPosition(m),p=m}}},e.chainPanels=function(){var o=this.panels.concat(this.clonedPanels);if(o.forEach(function(t,e){var n=0<e?o[e-1]:null,i=e<o.length-1?o[e+1]:null;t.setPrevPanel(n),t.setNextPanel(i)}),this.options.circular){var t=o[0],e=o[o.length-1];t.setPrevPanel(e),e.setNextPanel(t)}},e.moveToDefaultPanel=function(){var t=this.state,e=f(this.options.defaultIndex,0,this.panels.length-1),n=this.panels[e].getAnchorPosition()-t.hangerPosition;n=this.canSetBoundMode()?f(n,t.scrollArea.prev,t.scrollArea.next):n,t.index=e,this.moveCamera(n),this.axes.setTo({flick:n},0)},e.isOutOfBound=function(){var t=this.state,e=t.scrollArea;return!this.options.circular&&(t.position<e.prev||t.position>e.next)},e.canSetBoundMode=function(){var t=this.state,e=this.options,n=this.panels,i=n[n.length-1],o=i.getPosition()+i.getSize();return e.bound&&!e.circular&&o>=t.size},e.updateSize=function(){var t=this.state,e=this.options,n=this.viewportElement;e.horizontal||(n.style.width="",n.style.minWidth="");var i=n.getBoundingClientRect();t.size=e.horizontal?i.width:i.height,t.hangerPosition=g(e.hanger,t.size)},e.updateOriginalPanelPositions=function(){var i=this.options.gap,t=this.panels,o=0;t.forEach(function(t){t.resize();var e=o,n=t.getSize();t.setPosition(e),o+=n+i})},e.updateScrollArea=function(){var t=this.state,e=this.panels,n=this.options,i=this.axes,o=e[0],r=e[e.length-1],a=t.hangerPosition;if(this.canSetBoundMode())t.scrollArea={prev:o.getPosition(),next:r.getPosition()+r.getSize()-t.size};else if(n.circular){var s=r.getPosition()+r.getSize()+n.gap;t.scrollArea={prev:o.getAnchorPosition()-a,next:s+o.getRelativeAnchorPosition()-a}}else t.scrollArea={prev:o.getAnchorPosition()-a,next:r.getAnchorPosition()-a};var l,c=t.size,h=n.bounce,u=h;if((l=h)&&l.constructor===Array)u=h.map(function(t){return g(t,c,v.bounce)});else{var f=g(h,c,v.bounce);u=[f,f]}i.axis.flick.range=[t.scrollArea.prev,t.scrollArea.next],i.axis.flick.bounce=u},e.updateCameraPosition=function(){var t=this.state,e=this.panels,n=this.axes,i=e[t.index].getAnchorPosition()-t.hangerPosition;this.canSetBoundMode()&&(i=f(i,t.scrollArea.prev,t.scrollArea.next)),this.moveCamera(i),this.pause(),n.setTo({flick:i},0),this.resume()},e.makeNewPanInput=function(){var t=this.options;return new o.PanInput(this.viewportElement,{inputType:t.inputType,thresholdAngle:t.thresholdAngle,scale:t.horizontal?[-1,0]:[0,-1]})},e.appendPanelElement=function(t){this.cameraElement.appendChild(t)},t}(),e=function(){function t(){this.delta=0,this.direction=null,this.targetPanel=null}var e=t.prototype;return e.onEnter=function(t){this.delta=t.delta,this.direction=t.direction,this.targetPanel=t.targetPanel},e.onExit=function(t){},e.onHold=function(t,e){},e.onChange=function(t,e){},e.onRelease=function(t,e){},e.onAnimationEnd=function(t,e){},e.onFinish=function(t,e){},t}(),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=u,t.holding=!1,t.playing=!1,t}r(t,e);var n=t.prototype;return n.onEnter=function(){this.direction=null,this.targetPanel=null,this.delta=0},n.onHold=function(t,e){var n=e.triggerEvent,i=e.transitTo;n(M.HOLD_START,t,!0).onSuccess(function(){i(m)}).onStopped(function(){i(O)})},n.onChange=function(t,e){var n=e.triggerEvent,i=e.transitTo;n(M.MOVE_START,t,!1).onSuccess(function(){i(R).onChange(t,e)}).onStopped(function(){i(O)})},t}(e),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=m,t.holding=!0,t.playing=!0,t.releaseEvent=null,t}r(t,e);var n=t.prototype;return n.onChange=function(t,e){var n=e.flicking,i=e.triggerEvent,o=e.transitTo,r=n.options.horizontal?t.inputEvent.offsetX:t.inputEvent.offsetY;this.direction=r<0?E.NEXT:E.PREV,i(M.MOVE_START,t,!0).onSuccess(function(){o(x).onChange(t,e)}).onStopped(function(){o(O)})},n.onRelease=function(t,e){var n=e.viewport,i=e.triggerEvent,o=e.transitTo;if(i(M.HOLD_END,t,!0),0!==t.delta.flick)return t.setTo({flick:n.getCameraPosition()},0),void o(u);this.releaseEvent=t},n.onFinish=function(t,e){var n=e.viewport,i=e.triggerEvent,o=e.transitTo,r=e.castToReadonlyPanel;if(o(u),this.releaseEvent){var a=this.releaseEvent.inputEvent.srcEvent.target,s=n.findPanelOf(a),l=n.getCameraPosition();if(s){var c=s.getPosition();i(M.SELECT,null,!0,{direction:l<c?E.NEXT:c<l?E.PREV:null,selectedIndex:s.getIndex(),selectedPanel:r(s)})}}},t}(e),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=x,t.holding=!0,t.playing=!0,t}r(t,e);var n=t.prototype;return n.onEnter=function(t){e.prototype.onEnter.call(this,t),this.delta=0},n.onChange=function(t,e){var n=e.moveCamera,i=e.transitTo;t.delta.flick&&n(t).onStopped(function(){i(O)})},n.onRelease=function(t,e){var n=e.flicking,i=e.viewport,o=e.triggerEvent,r=e.moveToPanel,a=e.castToReadonlyPanel,s=e.transitTo,l=e.stopCamera,c=this.delta,h=n.options,u=0<c,f=Math.abs(c),p=t.inputEvent.deltaX?Math.abs(180*Math.atan(t.inputEvent.deltaY/t.inputEvent.deltaX)/Math.PI):90,d=f>=h.threshold&&(h.horizontal?p<=h.thresholdAngle:p>h.thresholdAngle);if(o(M.HOLD_END,t,!0),!d&&this.targetPanel)return i.moveTo(this.targetPanel,t),void s(R);var g=i.getCurrentPanel(),v=i.getCameraPosition()+i.getHangerPosition(),P=h.gap/2,m=u?g.getSize()-g.getRelativeAnchorPosition()+P:g.getRelativeAnchorPosition()+P;m=Math.max(m,h.threshold);var x,E=Math.abs(t.delta.flick),A=h.freeScroll,S=A?1/0:h.snap,T=h.duration,C=a(A?i.findNearestPanel():g);if(A||d){var y=0;if(A||m<=E){for(var w=C.position;Math.abs(C.position-w)<E&&y<S;){var z=u?C.next():C.prev();if(!z)break;C=z,++y}A?x=t.duration:1<y&&(x=Math.min(T*y,Math.max(t.duration,T)))}if(!A&&y<=1)if(f<=m){var I=u?g.getNextPanel():g.getPrevPanel();if(h.circular){var b=g.getIdenticalPanels()[1];(N=Math.abs(g.getAnchorPosition()-v)>Math.abs(b.getAnchorPosition()-v))&&(I=u?b.getNextPanel():b.getPrevPanel())}C=a(null!=I?I:g)}else C=a(i.findNearestPanel())}else if(h.circular){b=g.getIdenticalPanels()[1];var N=Math.abs(g.getAnchorPosition()-v)>Math.abs(b.getAnchorPosition()-v);!u&&N&&(C=a(b))}r(C,d&&C.position!==g.getPosition()?M.CHANGE:A?M.NONE:M.RESTORE,t,x).onSuccess(function(){s(R)}).onStopped(function(){s(O),l(t)})},t}(e),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=R,t.holding=!1,t.playing=!0,t}r(t,e);var n=t.prototype;return n.onHold=function(t,e){var n=e.triggerEvent,i=e.transitTo;n(M.HOLD_START,t,!0).onSuccess(function(){i(x)}).onStopped(function(){i(O)})},n.onChange=function(t,e){var n=e.moveCamera,i=e.transitTo;t.delta.flick&&n(t).onStopped(function(){i(O)})},n.onFinish=function(t,e){var n=e.flicking,i=e.viewport,o=e.triggerEvent,r=e.transitTo,a=t&&t.isTrusted;o(M.MOVE_END,t,a),n.options.adaptive&&i.updateAdaptiveSize(),r(u)},t}(e),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=O,t.holding=!1,t.playing=!0,t}r(t,e);var n=t.prototype;return n.onAnimationEnd=function(t,e){(0,e.transitTo)(u)},n.onRelease=function(t,e){var n=e.transitTo;0===t.delta.flick&&n(u)},t}(e),n=function(){function t(){var i=this;this.state=new C,this.transitTo=function(t){var e=i.state;if(e.type!==t){var n=void 0;switch(t){case u:n=new C;break;case m:n=new y;break;case x:n=new w;break;case R:n=new z;break;case O:n=new I}e.onExit(n),n.onEnter(e),i.state=n}return i.state}}var e=t.prototype;return e.fire=function(t,e,n){var i=this.state;switch(t){case P.HOLD:i.onHold(e,n);break;case P.CHANGE:i.onChange(e,n);break;case P.RELEASE:i.onRelease(e,n);break;case P.ANIMATION_END:i.onAnimationEnd(e,n);break;case P.FINISH:i.onFinish(e,n)}},e.getState=function(){return this.state},t}();return function(f){function t(t,e){void 0===e&&(e={});var n,I=f.call(this)||this;if(I.plugins=[],I.triggerEvent=function(t,e,n,i){void 0===i&&(i={});var o=I.viewport,r=I.stateMachine.getState(),a=o.getCurrentPanel(),s=o.getScrollArea(),l=s.prev,c=s.next,h=b(o.getCameraPosition(),[l,l,c]);I.options.circular&&(h%=1);var u=!f.prototype.trigger.call(I,t,p({type:t,index:a.getIndex(),panel:I.castToReadonlyPanel(a),direction:r.direction,holding:r.holding,progress:h,axesEvent:e,isTrusted:n},i));return{onSuccess:function(t){return u||t(),this},onStopped:function(t){return u&&t(),this}}},I.moveCamera=function(t){var e=I.viewport,n=I.stateMachine.getState(),i=I.options,o=t.pos.flick;if(t.isTrusted&&n.holding){var r=(i.horizontal?t.inputEvent.offsetX:t.inputEvent.offsetY)<0,a=e.getCameraPosition(),s=o-a,l=r===o<a;if(i.circular&&l){var c=e.getScrollAreaSize();s=-Math.sign(s)*(c-Math.abs(s))}var h=0===s?n.direction:0<s?E.NEXT:E.PREV;n.delta+=s,n.direction=h}var u=e.getCameraPosition();return e.moveCamera(o),I.triggerEvent(M.MOVE,t,t.isTrusted).onStopped(function(){e.moveCamera(u)})},I.stopCamera=function(t){var e=I.viewport;t&&t.setTo&&t.setTo({flick:e.getCameraPosition()},0),I.stateMachine.transitTo(u)},I.moveToPanel=function(e,t,n,i){void 0===i&&(i=I.options.duration);var o,r=I.viewport,a=I.stateMachine,s=r.getCurrentPanel(),l=e.anchorPosition-r.getHangerPosition(),c=r.getCameraPosition(),h=null!==n,u=c<l?E.NEXT:E.PREV;return(o=t===M.CHANGE?I.triggerEvent(M.CHANGE,n,h,{index:e.index,panel:e,direction:u,prevIndex:s.getIndex(),prevPanel:I.castToReadonlyPanel(s)}):t===M.RESTORE?I.triggerEvent(M.RESTORE,n,h):{onSuccess:function(t){return t(),this},onStopped:function(t){return this}}).onSuccess(function(){var t=a.getState();t.targetPanel=e,t.direction=u,r.moveTo(e,n,i)}),i<=0&&a.fire(P.FINISH,null,I.eventContext),o},I.castToReadonlyPanel=function(i,o){void 0===o&&(o=i.getPosition());var r=I,t=I.options.circular,a=I.viewport,e=i.getSize(),n=i.getRelativeAnchorPosition(),s=a.getCameraPosition(),l=a.getHangerPosition(),c=s+l,h=I.viewport.findNearestPanel(),u=h.getAnchorPosition()>c||!h.getNextPanel(),f=(u?h.getPrevPanel():h)||h,p=(u?h:h.getNextPanel())||h,d=a.getScrollAreaSize(),g=a.getSize(),v=f.getAnchorPosition(),P=p.getAnchorPosition();P<v&&(v<c?P+=d:v-=d);var m=[v,v,P],x=[-e,l-n,g],E=I.getPanelCount(),A=f.getCloneIndex(),S=(t?Math.floor(o/d)*E:0)+i.getIndex()-b(c,m)-(f.getIndex()+(A+1)*E),T=o-s,C=b(T,x),y=T+e,w=Math.min(g,y)-Math.max(T,0),z=0<=w?w/e:0;return{element:i.getElement(),index:i.getIndex(),position:o,progress:S,outsetProgress:C,visibleRatio:z,anchorPosition:o+i.getRelativeAnchorPosition(),size:i.getSize(),focus:function(t){if(a.getCameraPosition()+a.getHangerPosition()!==i.getAnchorPosition()){var e=a.getCurrentPanel().getPosition();r.moveToPanel(this,e===o?M.NONE:M.CHANGE,null,t)}},update:function(e){i.getIdenticalPanels().forEach(function(t){return e(t.getElement())})},prev:function(){var t=i.getPrevPanel();if(null==t)return null;for(var e=a.getScrollAreaSize(),n=t.getPosition();o<n;)n-=e;return r.castToReadonlyPanel(t,n)},next:function(){var t=i.getNextPanel();if(null==t)return null;for(var e=a.getScrollAreaSize(),n=t.getPosition();n<o;)n+=e;return r.castToReadonlyPanel(t,n)}}},"string"==typeof t){if(!(n=document.querySelector(t)))throw new Error("Base element doesn't exist.")}else{if(!t.nodeName||1!==t.nodeType)throw new Error("Element should be provided in string or HTMLElement.");n=t}return I.wrapper=n,I.build(e),I}r(t,f);var e=t.prototype;return e.prev=function(t){return this.moveTo(this.viewport.getPrevIndex(),t)},e.next=function(t){return this.moveTo(this.viewport.getNextIndex(),t)},e.moveTo=function(t,e){var n=this.viewport,i=n.getPanel(t),o=this.stateMachine.getState();if(!i||o.type!==u)return this;if(n.getCameraPosition()+n.getHangerPosition()===i.getAnchorPosition())return this;var r=i.getIndex(),a=n.getIndex(),s=this.castToReadonlyPanel(n.findNearestIdenticalPanel(i));return this.moveToPanel(s,r===a?M.NONE:M.CHANGE,null,e),this},e.getIndex=function(){return this.viewport.getIndex()},e.getPrevIndex=function(){return this.viewport.getPrevIndex()},e.getNextIndex=function(){return this.viewport.getNextIndex()},e.getCurrentPanel=function(){return this.castToReadonlyPanel(this.viewport.getCurrentPanel())},e.getPanel=function(t){var e=this.viewport.getPanel(t);return e?this.castToReadonlyPanel(e):null},e.getAllPanels=function(t){var e=this;return this.viewport.getAllPanels(t).map(function(t){return e.castToReadonlyPanel(t)})},e.getVisiblePanels=function(){return this.getAllPanels(!0).filter(function(t){var e=t.outsetProgress;return-1<e&&e<1})},e.getPanelCount=function(){return this.viewport.getPanelCount()},e.isPlaying=function(){return this.stateMachine.getState().playing},e.enableInput=function(){return this.viewport.enable(),this},e.disableInput=function(){return this.viewport.disable(),this},e.getStatus=function(){var t=this.viewport.getAllPanels().map(function(t){return{html:t.getElement().outerHTML,index:t.getIndex()}});return{index:this.getIndex(),panels:t,position:this.viewport.getCameraPosition()}},e.setStatus=function(t){this.viewport.restore(t)},e.addPlugins=function(t){var e=this,n=[].concat(t);return n.forEach(function(t){t.init(e)}),this.plugins=this.plugins.concat(n),this},e.removePlugins=function(t){var n=this,i=this.plugins;return[].concat(t).forEach(function(t){var e=i.indexOf(t);-1<e&&i.splice(e,1),t.destroy(n)}),this},e.destroy=function(){var e=this;for(var t in this.off(),this.viewport.destroy(),this.plugins.forEach(function(t){t.destroy(e)}),this)this[t]=null},e.resize=function(){return this.viewport.resize(),this},e.build=function(t){this.setInitialState(t),this.initViewport(),this.listenInput(),this.listenResize()},e.setInitialState=function(t){this.options=p({},v,t),this.stateMachine=new n},e.initViewport=function(){var t=this.wrapper,e=this.options,n=t.children;if(!n||!n.length)throw new Error("Given base element doesn't have proper DOM structure to be initialized.");for(var i=document.createElement("div"),o=t.firstChild;o;)i.appendChild(o),o=t.firstChild;var r=document.createElement("div");r.appendChild(i),t.appendChild(r),this.viewport=new T(r,i,e)},e.listenInput=function(){var n=this,i=n.stateMachine;n.eventContext={flicking:n,viewport:n.viewport,transitTo:i.transitTo,triggerEvent:n.triggerEvent,moveCamera:n.moveCamera,stopCamera:n.stopCamera,moveToPanel:n.moveToPanel,castToReadonlyPanel:n.castToReadonlyPanel};var o={},t=function(t){var e=P[t];o[e]=function(t){return i.fire(e,t,n.eventContext)}};for(var e in P)t(e);n.viewport.connectAxesHandler(o)},e.listenResize=function(){var t=this;this.options.autoResize&&window.addEventListener("resize",function(){t.resize()})},t.VERSION="3.0.0-beta4",t.DIRECTION=E,t.EVENTS=M,t}(t)});
//# sourceMappingURL=flicking.min.js.map
